# 点餐小程序Demo产品文档

## 项目概述

**项目名称**: 点餐小程序Demo
**项目类型**: 移动端Web应用（微信小程序风格）
**数据来源**: 飞书多维表格
**目标用户**: 内部演示使用

## 功能需求

### 1. 用户登录
- 输入账号密码进行身份验证
- 验证数据来源：飞书多维表格用户表
- 登录成功后进入菜单页面
- 简单的表单验证和错误提示

### 2. 商家公告
- 在菜单页面顶部显示商家公告信息
- 公告内容从飞书多维表格读取
- 支持文本公告展示

### 3. 菜品分类展示
- 左右布局：左侧分类导航，右侧菜品列表
- 分类数据从飞书多维表格读取
- 菜品信息包含：图片、名称、价格、描述
- 点击分类切换对应菜品

### 4. 购物车功能
- 点击菜品可添加到购物车
- 购物车显示选中商品数量和总价
- 支持增加/减少商品数量
- 底部购物车栏显示总数量和总金额

### 5. 下单功能
- 点击结算直接下单，无需确认页面
- 自动生成订单号和下单时间
- 下单成功后显示订单成功页面
- 订单数据（包含商品明细）写入飞书多维表格

## 技术架构

### 前端技术栈
- **框架**: Vue.js 3 + Composition API
- **UI组件库**: Vant 4（移动端UI组件）
- **状态管理**: Pinia
- **HTTP客户端**: Axios
- **构建工具**: Vite
- **样式**: CSS3 + Flex布局

### 数据集成
- **数据源**: 飞书Wiki多维表格API
- **Wiki知识库**: https://hx9pg0opel7.feishu.cn/wiki/Einjw3fPoiw0UKk4WVOcu6l6nLe
- **认证方式**: 飞书开放平台应用认证
- **数据交互**: RESTful API
- **App Token**: H6RubLi8aadl13sUFGscl8WKn2f

## 飞书Wiki多维表格设计

所有数据表都存储在同一个Wiki多维表格中，通过不同的table_id区分：

### 表1: 用户表 (users)
**Table ID**: `tblu886lTbkK6M9Y`
**View ID**: `vew3s63Uc2`
**参考链接**: https://hx9pg0opel7.feishu.cn/wiki/Einjw3fPoiw0UKk4WVOcu6l6nLe?table=tblu886lTbkK6M9Y&view=vew3s63Uc2

| 字段名 | 类型 | 说明 |
|--------|------|------|
| username | 文本 | 用户账号 |
| password | 文本 | 用户密码 |
| name | 文本 | 用户姓名 |
| status | 单选 | 用户状态（启用/禁用） |

### 表2: 商家公告表 (announcements)
**Table ID**: `tblXlmOtsddXhZkg`
**View ID**: `vew3s63Uc2`
**参考链接**: https://hx9pg0opel7.feishu.cn/wiki/Einjw3fPoiw0UKk4WVOcu6l6nLe?table=tblXlmOtsddXhZkg&view=vew3s63Uc2

| 字段名 | 类型 | 说明 |
|--------|------|------|
| title | 文本 | 公告标题 |
| content | 多行文本 | 公告内容 |
| status | 单选 | 公告状态（启用/禁用） |
| created_time | 创建时间 | 发布时间 |

### 表3: 菜品分类表 (categories)
**Table ID**: `tblsowH9WdUHkDwa`
**View ID**: `vew3s63Uc2`
**参考链接**: https://hx9pg0opel7.feishu.cn/wiki/Einjw3fPoiw0UKk4WVOcu6l6nLe?table=tblsowH9WdUHkDwa&view=vew3s63Uc2

| 字段名 | 类型 | 说明 |
|--------|------|------|
| name | 文本 | 分类名称 |
| sort_order | 数字 | 排序序号 |
| status | 单选 | 分类状态（启用/禁用） |

### 表4: 菜品表 (dishes)
**Table ID**: `tblu0rGzAh8vYd90`
**View ID**: `vew3s63Uc2`
**参考链接**: https://hx9pg0opel7.feishu.cn/wiki/Einjw3fPoiw0UKk4WVOcu6l6nLe?table=tblu0rGzAh8vYd90&view=vew3s63Uc2

| 字段名 | 类型 | 说明 |
|--------|------|------|
| name | 文本 | 菜品名称 |
| description | 多行文本 | 菜品描述 |
| price | 数字 | 菜品价格 |
| image_url | 超链接 | 菜品图片链接 |
| category_id | 单向关联 | 关联分类表 |
| status | 单选 | 菜品状态（上架/下架） |
| sort_order | 数字 | 排序序号 |

### 表5: 订单表 (orders)
**Table ID**: `tblzlmAxzGG1Rxqb`
**View ID**: `vew3s63Uc2`
**参考链接**: https://hx9pg0opel7.feishu.cn/wiki/Einjw3fPoiw0UKk4WVOcu6l6nLe?table=tblzlmAxzGG1Rxqb&view=vew3s63Uc2

| 字段名 | 类型 | 说明 |
|--------|------|------|
| order_no | 文本 | 订单号 |
| username | 文本 | 用户账号 |
| total_amount | 数字 | 订单总金额 |
| total_quantity | 数字 | 商品总数量 |
| dishes_detail | 多行文本 | 订单明细JSON（包含菜品名称、单价、数量、小计） |
| status | 单选 | 订单状态（待处理/已完成/已取消） |
| order_time | 创建时间 | 下单时间 |

## 飞书API配置说明

### 应用凭证
```
APP_ID: cli_a9870d3a78b4d00c
APP_SECRET: ojOTmuycdC2NiCjCCGDechvcGU4PCtqB
```

### Wiki多维表格配置
```
Wiki知识库URL: https://hx9pg0opel7.feishu.cn/wiki/Einjw3fPoiw0UKk4WVOcu6l6nLe
App Token: H6RubLi8aadl13sUFGscl8WKn2f
```

### 各表配置汇总
| 表名 | Table ID | View ID | 说明 |
|------|----------|---------|------|
| 用户表 | tblu886lTbkK6M9Y | vew3s63Uc2 | 存储用户账号信息 |
| 商家公告表 | tblXlmOtsddXhZkg | vew3s63Uc2 | 存储商家公告 |
| 菜品分类表 | tblsowH9WdUHkDwa | vew3s63Uc2 | 存储菜品分类 |
| 菜品表 | tblu0rGzAh8vYd90 | vew3s63Uc2 | 存储菜品信息 |
| 订单表 | tblzlmAxzGG1Rxqb | vew3s63Uc2 | 存储订单数据 |

### API调用方式
所有表都使用相同的App Token，通过不同的Table ID来访问不同的数据表：

- **获取数据**: `GET /open-apis/bitable/v1/apps/{app_token}/tables/{table_id}/records`
- **创建记录**: `POST /open-apis/bitable/v1/apps/{app_token}/tables/{table_id}/records`
- **更新记录**: `PUT /open-apis/bitable/v1/apps/{app_token}/tables/{table_id}/records/{record_id}`

## 页面设计

### 1. 登录页面 (/login)
```
┌─────────────────────┐
│      登录页面        │
├─────────────────────┤
│                     │
│   [Logo/Title]      │
│                     │
│  ┌───────────────┐   │
│  │   用户名      │   │
│  └───────────────┘   │
│                     │
│  ┌───────────────┐   │
│  │   密码        │   │
│  └───────────────┘   │
│                     │
│  ┌───────────────┐   │
│  │   登录按钮     │   │
│  └───────────────┘   │
│                     │
└─────────────────────┘
```

### 2. 菜单页面 (/menu)
```
┌─────────────────────┐
│    商家公告栏        │
├─────────┬───────────┤
│ 分类1   │  菜品列表  │
│ 分类2   │           │
│ 分类3   │  ┌─────┐  │
│ 分类4   │  │图片 │  │
│         │  └─────┘  │
│         │  菜品名    │
│         │  ¥价格    │
│         │        [+]│
├─────────┴───────────┤
│  🛒 2件商品 ¥48.00  │
└─────────────────────┘
```

### 3. 购物车页面 (/cart)
```
┌─────────────────────┐
│      购物车          │
├─────────────────────┤
│ 菜品A  [-] 2 [+] ¥20│
│ 菜品B  [-] 1 [+] ¥15│
│ 菜品C  [-] 3 [+] ¥30│
├─────────────────────┤
│           总计: ¥65 │
│  ┌───────────────┐   │
│  │   立即下单     │   │
│  └───────────────┘   │
└─────────────────────┘
```

### 4. 订单成功页面 (/order-success)
```
┌─────────────────────┐
│      下单成功        │
├─────────────────────┤
│        ✓           │
│   下单成功！        │
│                     │
│ 订单号: #20241111001│
│ 总金额: ¥65.00      │
│                     │
│  ┌───────────────┐   │
│  │   返回首页     │   │
│  └───────────────┘   │
└─────────────────────┘
```

## 开发流程

### 阶段1: 环境搭建
1. 创建Vue.js项目
2. 安装Vant UI组件库
3. 配置路由和状态管理
4. 设置飞书API配置

### 阶段2: 数据集成
1. 在飞书Wiki中创建/使用多维表格
2. 配置飞书应用API访问权限
3. 封装飞书Wiki多维表格API调用方法
4. 实现数据获取和提交（使用统一的App Token和不同的Table ID）

### 阶段3: 页面开发
1. 实现登录页面和验证逻辑
2. 开发菜单展示页面
3. 实现购物车功能
4. 完成直接下单流程

### 阶段4: 测试与优化
1. 功能测试
2. 移动端适配测试
3. 性能优化
4. 用户体验优化

## 开发时间预估

- **环境搭建**: 0.5天
- **飞书API集成**: 1天
- **登录功能**: 0.5天
- **菜单展示**: 1天
- **购物车功能**: 1天
- **直接下单功能**: 0.5天
- **UI优化测试**: 1天

**总计**: 约5.5个工作日

## 技术难点与解决方案

### 1. 飞书API跨域问题
- 方案：使用代理服务器或配置CORS
- 备选：部署简单的Node.js中间层

### 2. 移动端适配
- 方案：使用Vant组件库确保移动端体验
- 备选：媒体查询和flex布局

### 3. 状态管理
- 方案：使用Pinia管理购物车状态
- 备选：本地存储配合组件状态

## 部署方案

### 开发环境
- 本地开发：`npm run dev`
- 热重载和实时预览

### 生产环境
- 构建：`npm run build`
- 静态文件部署到CDN或Web服务器
- 推荐平台：Vercel、Netlify或阿里云OSS

## 总结

这个点餐小程序Demo采用现代化的前端技术栈，结合飞书Wiki多维表格作为数据源，通过简化的业务流程（直接下单、合并订单表结构）能够快速实现一个功能完整的演示应用。

### 使用Wiki多维表格的优势
1. **统一管理**: 所有数据表集中在一个Wiki知识库中，便于查看和管理
2. **权限控制**: 利用Wiki的权限体系，统一控制数据访问权限
3. **数据可视化**: 可以直接在Wiki中查看和编辑数据，无需单独的管理后台
4. **协作便利**: 团队成员可以在Wiki中直接查看和维护数据
5. **API统一**: 使用同一个App Token，只需切换Table ID即可访问不同表

整体架构简单清晰，开发效率高，便于维护，满足演示需求的同时也具备良好的用户体验。